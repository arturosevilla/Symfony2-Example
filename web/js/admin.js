
function ProductCRUD(a,b,c,d,e){this.count=e?e:10;this.total=b;this.path=c;this.editPath=d;this.page=1;this.table=$(a.substr(0,1)==="#"?a:"#"+a);var f=this;this.table[0].setPage=function(a){f.setPage(a)};a=this.getTotalPages();b=$("<td>",{colspan:"4"});for(c=1;c<=a;c++)b.append($("<a>",{href:"javascript:void(0)",onclick:"javascript:__setPage(this, "+c+")"}).text(c.toString()));$("tfoot",this.table).html("").append(b)}
ProductCRUD.prototype.fillTable=function(a){$("tbody",this.table).html("");var b=this;a.length===0?$("tbody",this.table).html('<tr><td colspan="4">No data</td></tr>'):$.each(a,function(a,d){var e=d.id;$("<tr>").append($("<td>").text(d.name)).append($("<td>").text(d.description)).append($("<td>").text(d.cost)).append($("<td>").append($("<a>").attr("href",b.editPath.replace("_id_",e)).text("Edit"))).appendTo($("tbody",b.table))})};
ProductCRUD.prototype.getTotalPages=function(){return this.total/this.count+(this.total%this.count==0?0:1)};ProductCRUD.prototype.setPage=function(a){if(!(a<=0||a>this.getTotalPages()))this.page=a,this.getData()};ProductCRUD.prototype.getData=function(){var a=this.path.replace("_offset_",(this.count*(this.page-1)).toString()).replace("_count_",this.count.toString()),b=this;$.get(a,function(a){b.fillTable(a)})};function setPage(a,b){$(a).parentsUntil("table").parent()[0].setPage(b);return!1}
window.ProductCRUD=ProductCRUD;window.__setPage=setPage;

function OrderManager(a,b,c){this.id=$("div.order-item-id",$(a)).text();this.nextUrl=b.replace("_id_",this.id);this.errorUrl=c.replace("_id_",this.id);this.element=a}OrderManager.prototype._reportStage=function(a){var b=this;$.get(a,function(a){$("span.order-item-status-text",$(b.element)).text(a)})};OrderManager.prototype.reportNextStage=function(){this._reportStage(this.nextUrl)};OrderManager.prototype.reportError=function(){this._reportStage(this.errorUrl)};
function report(a,b){var c=$(a).parentsUntil("div.order-item").parent()[0].orderManager;b=="next"?c.reportNextStage():c.reportError();return!1}window.__reportStage=report;window.OrderManager=OrderManager;
